<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTO Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- com.green.board.mapper -->
<mapper namespace='com.green.board.mapper.BoardMapper'>
	
	<insert id="insertBoard" parameterType="BoardDTO">
		INSERT INTO board(writer,subject,writerPw,content,id) 
		values(#{writer},#{subject},#{writerPw},#{content},#{id})
	</insert>
	
	<select id="getAllboard" resultType="BoardDTO">
		SELECT * FROM board ORDER BY num DESC
	</select>
	
	<!-- 게시글 클릭하면 조회수 업 -->
	<update id="updateReadBoard" parameterType="int">
		UPDATE board SET readcount= readcount+1 WHERE num=#{num}
	</update>
	
	<!-- 하나만 선택하는 -->
	<select id="getOneBoard" parameterType="int" resultType="BoardDTO">
		SELECT * FROM board WHERE num=#{num}
	</select>
	
	<update id="updateBoard" parameterType="BoardDTO">
		UPDATE board SET subject=#{subject}, content=#{content} WHERE num=#{num} AND writerPw=#{writerPw}
	</update>
	
	<delete id="deleteBoard" >
		DELETE FROM board WHERE num=#{num} AND writerPw=#{writerPW}
	</delete>
	
	<!-- 검색 -->
	<select id="getSearchBoard" resultType="BoardDTO">
		SELECT * FROM board
		<where>
			<choose>
				<!-- <when test="조건식" => a == b> -->
				<when test="searchType == 'subject'">
					subject LIKE CONCAT("%" , #{searchKeyword} , "%")
				</when>
				<otherwise>
					content LIKE CONCAT("%" , #{searchKeyword} , "%")
				</otherwise>
			</choose>
		</where>
		ORDER BY num DESC
	</select>
	
	
</mapper>